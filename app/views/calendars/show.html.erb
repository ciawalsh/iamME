<div id="clock">
  <div class="dynamic-time">
    <h3><span class="time">00:00</span></h3>
  </div>
  <!-- <div class="icon arrow"></div> -->
</div>

<section class="left-arrow">
  <%= link_to (image_tag("arrow_previous.png")), user_calendar_path(current_user, @calendar.id)+ "?wkid=#{(params[:wkid].to_i)-1}", id: 'arrow-previous' %>
</section>
<section class="right-arrow">
  <%= link_to (image_tag("arrow_next.png")), user_calendar_path(current_user, @calendar.id)+ "?wkid=#{(params[:wkid].to_i)+1}", id: 'arrow-next' %>
</section>

<section id="days-and-calendar">

<table>
<tr class='days'>
  <td>Monday</td>
  <td>Tuesday</td>
  <td>Wednesday</td>
  <td>Thursday</td>
  <td>Friday</td>
  <td>Saturday</td>
  <td>Sunday</td>
</tr>
</table>

<section id="calendar">

  <% while @day <= @sunday %>
    <% @hour = Time.parse("1:00 am", @time)%>
    <% @calendar = Calendar.find(params[:id]) %>
    <% @events = @calendar.events.all.select {|event| event.date.strftime('%Y-%m-%d') == @day.strftime('%Y-%m-%d') } %>


    <section class="day" id= <%="#{@day.strftime('%Y-%m-%d')}"%>>
      <% while @hour <= @number_of_hours %>
        <% number = 0 %>
        <% @count = @events.select {|event| event.date.strftime("%H:%M") == @hour.strftime('%H:%M') }.count %>
        <% @event = @events.select {|event| event.date.strftime("%H:%M") == @hour.strftime('%H:%M') }[number] %>

        <section class="widget-container">
          <% if @event%>

            <div class="widget-small" id= <%="#{@hour.strftime('%H:%M')}"%> style="background-image:url(<%= @event.image.url(:medium) %>);">
              <div id='map-canvas'></div>
              <a><%= image_tag("more_info.png", :class => 'more') %></a>
              <a><%= image_tag("play_button.png", :class => 'play') %></a>
              <a><%= image_tag("plus.png", :class => 'plus') if @count > 1 %></a>

              <div id="name-and-location">
                <h1 class='title'>   <%= @event.name %></h1>
                <h2 class='location'><%= @event.location %></h2>
              </div>

              <section id='bottom-section'>
                <div class="description"><p><%= @event.description %></p></div>
                <p class='large-icons'><%= image_tag("map.svg", :id => 'map', :class => 'map') %></p>
                <p class='large-icons'><%= image_tag("price_tag.svg", :id => 'price') %>         </p>
                <p class='large-icons'><%= image_tag("share.svg", :id => 'share') %>             </p>
                <p class='large-icons'><%= link_to image_tag("edit.png", :id => 'edit'), '/users/' + current_user.id.to_s + '/events/' + @event.id.to_s + '/edit' %>  </p>
                <!-- <%= link_to image_tag("ME.jpg", :class => 'me'), {:controller => "calendars", :action => "mebutton", :event_id => @event.id } %> -->
                <%= button_to image_tag("ME.jpg", :class => 'me'), {:controller => "calendars", :action => "mebutton", :event_id => @event.id } %>
                <p class='large-icons'><%= link_to image_tag("edit.png", :id => 'edit'), '/users/' + current_user.id.to_s + '/events/' + @event.id.to_s + '/edit', id: 'edit-event' %>  </p>
              </section>
            </div>
          <% end %>
        </section>


        <% @hour = @hour + 3600%>
      <% end%>
    </section>
    <% @day = @day.next_day %>
  <%end %>
</section>
